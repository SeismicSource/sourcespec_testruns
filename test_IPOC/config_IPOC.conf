# config_IPOC.conf
# Test run of source_spec on data from Integrated Plate Boundary Observatory
# Chile (IPOC)

# GENERAL PARAMETERS --------
DEBUG = False

PLOT_SHOW = False
PLOT_SAVE = True
PLOT_SAVE_FORMAT = png

# Trace format
# Currently supported: 'Antilles', 'CRL', 'ISNet', 'IPOC', 'mseed'
trace_format = IPOC

# Channel naming for mis-oriented channels (vertical, horiz1, horiz2):
# Example:
#   mis_oriented_channels = Z,1,2
mis_oriented_channels = None

# List of stations to ignore
ignore_stations = None

# List of stations to use
use_stations = None

# Path to pickle catalog (for 'Antilles' format)
pickle_catalog = None
pickle_classpath = None

# Directory or file for dataless:
dataless = None

# Alternatively, a directory with PAZ files can be specified:
paz = None

# Traceid file, in json format, for station SCNL correction (optional):
traceids = None

# Database file for storing output parameters (optional):
database_file = None

# correct_instrumental_reponse (optional, default=True):
#   'True', 'False' or 'sensitivity only'
# If 'sensitivity only', traces are not fully deconvolved
# for the instrumental response: only the
# sensitivity is corrected (faster, especially
# on a large number of traces).
correct_instrumental_response = True

# pre_filt:
# Pre-filtering frequencies for instrument correction
# Specify the four corner frequencies (f1,f2,f3,f4)
# of a cosine taper which is one between f2 and f3
# and tapers to zero for f1 < f < f2 and f3 < f < f4.
pre_filt = 0.1, 0.2, 55.0, 60.0
# -------- GENERAL PARAMETERS


# INITIAL PARAMETERS --------
# P and S wave velocity:
vp = 5.5
vs = 3.8438
# As an alternative, a NLL model dir can be used
NLL_model_dir = None
# density:
rho = 2900.0
# radiation pattern coefficient:
rps = 0.67
# Brune stress drop (MPa):
bsd = 5000000.0
# -------- INITIAL PARAMETERS

# Maximum epicentral distance (km) to process a trace
max_epi_dist = None

# S/N PARAMETERS --------
# Minimum rms (in trace units before instrument corrections)
# to consider a trace as noise
rmsmin = 1e-10

# P and S wave velocity for travel time calculation
# (if None, a global velocity model is used instead)
vp_tt = None
vs_tt = None
# As an alternative, a NLL travel time dir can be used
NLL_time_dir = None

# Arrival tolerances
p_arrival_tolerance = 4.0
s_arrival_tolerance = 4.0

# Noise window for S/N and noise weighting
pre_p_time = 10.0
# noise_win_length is only used for S/N
# noise weighting function uses s_win_length
# (see further below)
noise_win_length = 10.0

# S/N ratio min
sn_min = 1.0

# tolerance value (percent of trace max)
# to consider a local maximum as a clipped sample
clip_tolerance = 20.0
# maximum percentage of clipped data
# respect to the total trace lenght
clip_nmax = 0.5

# maximum gap length for the whole trace, in seconds
gap_max = None
# maximum overlap length for the whole trace, in seconds
overlap_max = None
# -------- S/N PARAMETERS


# SPECTRUM PARAMETERS --------
wave_type = S

time_domain_int = True
ignore_vertical = False

# S-wave window (sec)
pre_s_time = 1.0
s_win_length = 10.0

# Taper
# between 0 (no taper) and 0.5
taper_halfwidth = 0.05

# Spectral window length (sec)
# Signal is tapered, and then zero padded to
# this window length, so that the spectral
# sampling is fixed to 1/spectral_win_length.
# Comment out (or set to None) to use
# S-wave window as spectral window length.
spectral_win_length = 10.0

# Residuals file path
# (a pickle file with the
# mean residuals per station,
# used for station correction):
residuals_filepath = None

# Band-pass frequencies for accelerometers and velocimeters (Hz)
# TODO: calculate from sampling rate?
bp_freqmin_acc = 0.1
bp_freqmax_acc = 50.0
bp_freqmin_shortp = 0.25
bp_freqmax_shortp = 50.0
bp_freqmin_broadb = 0.25
bp_freqmax_broadb = 50.0

# Filter cut frequencies for accelerometers and velocimeters
freq1_acc = 0.1
freq2_acc = 30.0
freq1_shortp = 0.5
freq2_shortp = 50.0
freq1_broadb = 0.5
freq2_broadb = 50.0
# -------- SPECTRUM PARAMETERS


# INVERSION PARAMETERS --------
# weighting type
weighting = noise
# parameters for frequency weighting:
#   weight for f<=f_weight
#   1      for f> f_weight
f_weight = 7.0
weight = 5.0
norm_weight_integral_min = None
# spectral S/N ratio min,
# below which a spectrum will be skipped
spectral_sn_min = 0.0
# frequency range to compute spectral S/N ratio
spectral_sn_freq_range = None
# initial values for fc (optional)
fc_0 = 8.0
# initial value for t_star
t_star_0 = 0.045
# try to invert for t_star_0. If inverted t_star_0 is non-positive,
# then fixed t_star_0 will be used
invert_t_star_0 = False
# allowed variability around inverted t_star_0 in the main inversion
# (expressed as a fraction of t_star_0, between 0 and 1).
# If inverted t_star_0 is non-positive, then t_star_min_max is used.
t_star_0_variability = 0.1
# inversion algorithm
# LM: Levenberg-Marquardt algorithm
# (warning: Trust Region Reflective algorithm will be used instead if
#  bounds are provided)
# TNC: truncated Newton algorithm (with bounds)
inv_algorithm = LM
# parameter bounds
# specify bounds as a list, ex.:
#   fc_min_max = 0.1, 40
# comment out or use None to indicate no bound
fc_min_max = 1.0, 20.0
# t_star_min_max does not superseed t_star_0_variability
t_star_min_max = None
# optional : Qo bounds (converted
# into t_star bounds in the code).
# comment out or use None to indicate no bound
Qo_min_max = None
# -------- INVERSION PARAMETERS

# RADIATED-ENERGY PARAMETERS --------
# maximum frequency (Hz) to measure radiated energy Er
# (above this frequeny, the finite-band correction
# of Di Bona & Rovelli, 1988, will be applied)
max_freq_Er = None
# -------- RADIATED-ENERGY PARAMETERS

# POST-PROCESSING PARAMETERS --------
# Min and max acceptable corner frequencies (Hz)
min_corner_freq = 2.0
max_corner_freq = 50.0
# -------- POST-PROCESSING PARAMETERS


# LOCAL MAGNITUDE PARAMETERS --------
compute_local_magnitude = True
# Local magnitude parameters:
#   ml = log10(A) + a * log10(R/100) + b * (R-100) + c
# where A is the maximum W-A amplitude (in mm)
# and R is the hypocentral distance (in km)
# Default values (for California) are:
#   a = 1., b = 0.00301, c = 3.
a = 1.0
b = 0.00301
c = 3.0
# -------- LOCAL MAGNITUDE PARAMETERS

# Plots an extra synthetic spectrum with no attenuation
plot_spectra_no_attenuation = False
# Plots an extra synthetic spectrum with no fc
plot_spectra_no_fc = False
# Max number of rows in plots
plot_spectra_maxrows = 3
plot_traces_maxrows = 3
# Plot station map
plot_station_map = True
plot_station_names_on_map = True
plot_station_text_size = 8.0
